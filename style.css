/* -------------------------------------------------------------
   Form Suite — Polished, professional theme
   Works across Open Form, Builder, Matcher, Extractor.
   ------------------------------------------------------------- */

/* ============ TOKENS ============ */
:root {
  /* layout */
  --maxw: 1100px;
  --gap: 12px;
  --radius-sm: 8px;
  --radius: 10px;
  --radius-lg: 14px;

  /* colors */
  --bg: #f8fafc;
  --card: #ffffff;
  --ink: #0f172a;
  --muted: #6b7280;
  --border: #e5e7eb;        /* light grid */
  --border-strong: #d1d5db; /* visible field borders */
  --accent: #111827;        /* primary button bg (light) */
  --accent-ink: #ffffff;

  --accent-weak: #374151;
  --accent-weak-ink: #ffffff;
  --ghost-bg: #eef2f7;
  --ghost-ink: #111827;
  --warn-bg: #fff7ed;
  --warn-border: #fed7aa;
  --warn-ink: #9a3412;

  /* focus */
  --focus-border: #9aa7ff;
  --focus-ring: rgba(99,102,241,.28);

  /* shadows */
  --shadow-sm: 0 1px 2px rgba(0,0,0,.06);
  --shadow-md: 0 4px 14px rgba(0,0,0,.08);
  --shadow-lg: 0 12px 24px rgba(0,0,0,.12);

  /* animation */
  --dur-fast: 120ms;
  --dur: 200ms;
  --dur-slow: 340ms;
  --ease: cubic-bezier(.2,.8,.2,1);

  /* brand */
  --logo-size: 32px;
}

/* Optional auto dark mode */
@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0b1220;
    --card: #121a2b;
    --ink: #e5ebf5;
    --muted: #9aa3b2;
    --border: #1f2a3e;
    --border-strong: #2a3550;     /* stay clearly visible in dark */
    --ghost-bg: #1a2336;
    --ghost-ink: #e5ebf5;
    --accent: #5b9aff;            /* primary button bg (dark) */
    --accent-ink: #061229;
    --accent-weak: #2b3b5f;
    --accent-weak-ink: #e5ebf5;
    --warn-bg: #281d12;
    --warn-border: #7a4a14;
    --warn-ink: #ffb86b;
    --shadow-sm: 0 1px 2px rgba(0,0,0,.35);
    --shadow-md: 0 6px 18px rgba(0,0,0,.35);
    --shadow-lg: 0 16px 34px rgba(0,0,0,.45);
    --focus-border: #86a7ff;
    --focus-ring: rgba(134,167,255,.28);
  }
}

/* ============ BASE ============ */
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
  color: var(--ink);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

@keyframes fs-fade-in { from{opacity:0;transform:translateY(4px)} to{opacity:1;transform:translateY(0)} }

* { scrollbar-width: thin; scrollbar-color: var(--border) transparent; }
*::-webkit-scrollbar { height: 10px; width: 10px; }
*::-webkit-scrollbar-thumb { background: var(--border); border-radius: 999px; }
*::-webkit-scrollbar-track { background: transparent; }

/* ============ HEADER ============ */
header { 
  position: sticky; top: 0; z-index: 10; overflow: hidden;
  background: linear-gradient(180deg, #111827 0%, #0f172a 100%);
  color: #fff; box-shadow: var(--shadow-sm);
}
header .row {
  max-width: var(--maxw);
  margin: 0 auto;
  padding: 14px 18px;
  display: flex;
  gap: 14px;
  align-items: center;
}
header a { color: #049ad4; text-decoration: none; position: relative; }
header a::after {
  content: ""; position: absolute; left: 0; bottom: -3px; height: 2px; width: 0;
  background: currentColor; transition: width var(--dur) var(--ease);
}
header a:hover::after { width: 100%; }
header a:hover { filter: brightness(1.06); }
header::after {
  content: ""; position: absolute; left: 0; right: 0; bottom: 0; height: 2px;
  background: linear-gradient(90deg, #60a5fa, #34d399, #f59e0b, #60a5fa);
  background-size: 300% 100%; animation: fs-header-sheen 10s linear infinite; opacity: .9;
}
@keyframes fs-header-sheen { 0%{background-position:0% 50%} 100%{background-position:300% 50%} }

header .brand { display: inline-flex; align-items: center; gap: 10px; margin-right: auto; }
header .logo, header img.logo {
  height: var(--logo-size); width: auto; display: inline-block; vertical-align: middle;
  border-radius: 6px; box-shadow: var(--shadow-sm);
  background: rgba(255,255,255,.06); outline: 1px solid rgba(255,255,255,.07);
}
header .row .logo { margin-right: 8px; }
.logo-xs{--logo-size:20px}.logo-sm{--logo-size:24px}.logo-md{--logo-size:28px}.logo-lg{--logo-size:36px}.logo-xl{--logo-size:48px}

/* ============ LAYOUT ============ */
main {
  max-width: var(--maxw);
  margin: 20px auto;
  padding: 0 14px 40px;
  display: grid; gap: 16px;
  animation: fs-fade-in var(--dur-slow) var(--ease) both;
}
.grid{display:grid;gap:16px} .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.bar{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-bottom:10px}
.grid-2{display:grid;gap:16px}
body.open .grid-2{grid-template-columns:1fr}
body.builder .grid-2{grid-template-columns:1.05fr 1fr}
body.extractor .grid-2{grid-template-columns:1.4fr 1fr}
@media (max-width:1050px){.grid-2{grid-template-columns:1fr!important}}

/* ============ SURFACES ============ */
.panel {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  box-shadow: var(--shadow-sm);
  animation: fs-fade-in var(--dur) var(--ease) both;
}
.panel + .panel { margin-top: 2px; }

.card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px;
  background: var(--card);
  box-shadow: var(--shadow-sm);
  transition: box-shadow var(--dur) var(--ease), transform var(--dur) var(--ease);
}
.card:hover { box-shadow: var(--shadow-md); transform: translateY(-1px); }

.table-card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--card);
  padding: 10px;
  box-shadow: var(--shadow-sm);
}

/* ============ TEXT & TOKENS ============ */
.muted{color:var(--muted)} .subtle{font-size:12px;color:var(--muted)}
.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
.kbd{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:#eef2ff;border:1px solid #c7d2fe;padding:2px 6px;border-radius:6px}
.k{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;background:rgba(127,127,255,.12);border:1px solid rgba(127,127,255,.35);padding:2px 6px;border-radius:6px}
.pill{display:inline-block;padding:2px 10px;border-radius:999px;border:1px solid currentColor;margin:0 6px 6px 0;font-size:.85rem;line-height:1.9;color:var(--muted);background:transparent}
.chips{display:flex;gap:6px;flex-wrap:wrap}.chip{font-size:12px;padding:2px 8px;border-radius:999px;background:#eef2ff;border:1px solid #c7d2fe;color:#3730a3}

/* ============ FORMS ============ */
.field{display:grid;gap:6px;margin-bottom:10px}

input[type="text"],
input[type="number"],
select,
textarea {
  width: 100%;
  padding: 10px 12px;
  border: 1.5px solid var(--border-strong);  /* always visible */
  border-radius: var(--radius-sm);
  font-size: 14px;
  background: var(--card);
  color: var(--ink);
  outline: none;
  transition: border-color var(--dur) var(--ease), box-shadow var(--dur) var(--ease), background var(--dur) var(--ease);
  background-clip: padding-box;
  box-shadow: inset 0 1px 0 rgba(0,0,0,.02);
}
textarea{min-height:180px;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:.95em;resize:vertical}

/* Focus ring */
:focus-visible { outline: 3px solid var(--focus-ring); outline-offset: 2px; }
input[type="text"]:focus,
input[type="number"]:focus,
select:focus,
textarea:focus {
  border-color: var(--focus-border);
  box-shadow: 0 0 0 3px var(--focus-ring);
}

/* Hover */
input[type="text"]:hover,
input[type="number"]:hover,
select:hover,
textarea:hover { border-color: #cbd5e1; }

/* Date inputs (flatpickr compat) */
input[data-type="date"] { background-image: linear-gradient(to right, transparent, transparent); }

/* ============ BUTTONS ============ */
button {
  /* Robust defaults to avoid white-on-white */
  --btn-bg: var(--accent);
  --btn-ink: var(--accent-ink);
  appearance: none;
  padding: 10px 14px;
  border: 1px solid transparent;
  background: var(--btn-bg, #111827);
  color: var(--btn-ink, #ffffff);
  border-radius: var(--radius-sm);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  transition: transform var(--dur) var(--ease), box-shadow var(--dur) var(--ease), filter var(--dur) var(--ease), background var(--dur) var(--ease), color var(--dur) var(--ease);
}
button:hover { transform: translateY(-1px); box-shadow: var(--shadow-md); }
button:active { transform: translateY(0); box-shadow: var(--shadow-sm); filter: brightness(.98); }

button.secondary { --btn-bg: var(--accent-weak); --btn-ink: var(--accent-weak-ink); }
button.ghost { background: var(--ghost-bg); color: var(--ghost-ink); border-color: var(--border); box-shadow: none; }
button.icon  { padding: 6px 8px; font-size: 13px; border-radius: 7px; }

button.danger { background: #fee2e2; border-color: #fecaca; color: #991b1b; }
button.danger:hover { background: #fecaca; }

button[disabled], button:disabled {
  opacity: .55; cursor: not-allowed; filter: grayscale(.25);
  transform: none !important; box-shadow: none !important;
}

/* Ensure primary Add/Update button is always readable */
#btnAdd {
  background: var(--accent, #111827);
  color: var(--accent-ink, #ffffff);
  border-color: var(--accent, #111827);
}

/* Button groups */
.bar > button + button { margin-left: 2px; }

/* ============ TABLES (generic) ============ */
table { width: 100%; border-collapse: separate; border-spacing: 0; }
.table-card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--card);
  padding: 0; overflow: hidden; box-shadow: var(--shadow-sm);
}
.table-card .table-wrap { padding: 10px; }
table, table.ruled { border: 1px solid var(--border); border-radius: var(--radius-sm); }
thead th {
  position: sticky; top: 0; z-index: 1; background: var(--card);
  border-bottom: 2px solid var(--border); padding: 10px 12px; text-align: left; font-weight: 600;
}
th, td {
  padding: 10px 12px; vertical-align: top;
  border-right: 1px solid var(--border); border-bottom: 1px solid var(--border);
}
th:last-child, td:last-child { border-right: 0; }
tr:last-child td { border-bottom: 0; }
tbody tr:nth-child(odd)  { background: rgba(127,127,127,.04); }
tbody tr:hover           { background: rgba(48,136,255,.08); }
table.compact th, table.compact td { padding: 6px 8px; }

/* ============ BUILDER: Fields table + DnD ============ */
#fieldTable {
  width: 100%; border-collapse: separate; border-spacing: 0;
  border: 1px solid var(--border); border-radius: 10px; overflow: hidden; background: var(--card);
}
#fieldTable thead th {
  text-align: left; font-weight: 600; padding: 10px 12px;
  border-bottom: 1.5px solid var(--border); background: #f3f4f6; white-space: nowrap;
}
#fieldTable tbody td {
  padding: 9px 12px; border-bottom: 1px solid var(--border);
  border-right: 1px solid var(--border); vertical-align: top;
}
#fieldTable tbody tr:last-child td { border-bottom: 0; }
#fieldTable tbody td:last-child { border-right: 0; }
#fieldTable tbody tr:hover { background: #f9fafb; }
#fieldTable tbody tr.is-active { background: #eef2ff; outline: 2px solid #c7d2fe; outline-offset: -2px; }
#fieldTable .mono { font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; }
.dnd-handle { cursor: grab; user-select: none; font-size: 18px; opacity: 0.85; }
tr.dragging { opacity: 0.5; }
.drop-target-above { box-shadow: inset 0 3px 0 0 #93c5fd; }
.drop-target-below { box-shadow: inset 0 -3px 0 0 #93c5fd; }

/* ============ BUILDER: Table Designer (.tdz-*) ============ */
.tdz-toolbar { display:flex; justify-content:space-between; align-items:center; margin:6px 0 10px; }
.tdz-head {
  display:grid; grid-template-columns: 180px 1fr 160px 1fr 130px; gap: 12px;
  padding: 8px 12px; background:#f3f4f6;
  border:1.5px solid var(--border); border-bottom: 0; border-radius: 10px 10px 0 0;
  font-size:12px; color: var(--muted); font-weight:600;
}
.tdz-grid > *:not(:first-child) { border-left: 1px dashed var(--border); padding-left: 12px; }
.tdz-row {
  display:grid; grid-template-columns: 180px 1fr 160px 1fr 130px; gap:12px;
  align-items:flex-start; padding:12px; background:#fff;
  border:1.5px solid var(--border); border-top:0;
}
.tdz-row:first-child { border-top: 1.5px solid var(--border); }
.tdz-col { display:flex; flex-direction:column; gap:6px; }
.tdz-col > label.small { color: var(--muted); font-size: 12px; }
.tdz-col > input, .tdz-col > select {
  height: 36px; padding: 6px 10px;
  border: 1.5px solid var(--border-strong);
  border-radius: 8px; background: #fff; outline: none; min-width: 160px;
  box-shadow: inset 0 1px 0 rgba(0,0,0,.02);
  transition: box-shadow .15s ease, border-color .15s ease, background-color .15s ease;
}
.tdz-col > input::placeholder { color:#9ca3af; }
.tdz-col > input:focus, .tdz-col > select:focus { border-color: var(--focus-border); box-shadow: 0 0 0 3px var(--focus-ring); background: #fff; }
.tdz-grow { flex:1 1 auto; }
.tdz-actions { display:flex; gap:8px; align-items:center; justify-content:flex-end; }
.tdz-chipwrap { display:flex; flex-wrap:wrap; gap:6px; }
.tdz-chip {
  display:inline-flex; align-items:center; gap:6px;
  padding:2px 10px; border:1.5px solid var(--border);
  border-radius:999px; background:#fff; line-height: 22px; box-shadow: 0 1px 0 rgba(0,0,0,.02);
}
.tdz-chip button { border:none; background:transparent; cursor:pointer; font-size: 16px; line-height: 1; }
.tdz-opts { display:flex; gap:8px; align-items:center; }
.tdz-muted { color:var(--muted); font-size:12px; }

/* ============ HELPERS ============ */
.hr { height: 1px; background: var(--border); margin: 10px 0; }
.drag { cursor: grab; user-select: none; padding: 2px 6px; border-radius: 6px; background: #f3f4f6; border: 1px solid #e5e7eb; font-size: 12px; }
.empty { padding: 12px; border: 1px dashed var(--border); border-radius: var(--radius-sm); background: var(--card); color: var(--muted); text-align: left; }
.warn { background: var(--warn-bg); border: 1px solid var(--warn-border); color: var(--warn-ink); padding: 8px 10px; border-radius: var(--radius-sm); font-size: 13px; }
.status { font-style: normal; color: var(--muted); }
.title-row { display: flex; align-items: baseline; gap: 10px; flex-wrap: wrap; }

/* Details/summary polish */
summary { cursor: pointer; list-style: none; transition: color var(--dur) var(--ease); }
summary::marker, summary::-webkit-details-marker { display: none; }
summary::before { content: "▸"; display: inline-block; margin-right: 6px; transition: transform var(--dur) var(--ease); }
details[open] summary::before { transform: rotate(90deg); }

.mono b, .mono strong { font-weight: 600; }
code { font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; }

/* keep operator & Add selects from stretching */
.select-compact {
  flex: 0 0 auto;
  width: max-content;    /* size to text */
  min-width: 12ch;       /* but not too tiny */
}

/* slimmer “Add value …” dropdown */
.select-add {
  flex: 0 0 auto;
  width: max-content;
  min-width: 10ch;
  max-width: 22ch;       /* never huge */
}

/* make the condition row layout stable */
.rule-cond {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;       /* pills can wrap */
}

.rule-cond .pills {
  flex: 1 1 100%;        /* pills drop to next line when needed */
  min-width: 0;
}

/* ============ ANIMATIONS (helpers) ============ */
@keyframes fs-pulse { 0%,100%{box-shadow:0 0 0 0 rgba(48,136,255,.0)} 50%{box-shadow:0 0 0 6px rgba(48,136,255,.08)} }
.pulse-once { animation: fs-pulse 1.2s var(--ease) 1; }
@keyframes fs-shimmer { 0%{background-position:-200% 0} 100%{background-position:200% 0} }
.skeleton { position: relative; background: linear-gradient(90deg, rgba(127,127,127,.10) 25%, rgba(127,127,127,.18) 37%, rgba(127,127,127,.10) 63%); background-size: 400% 100%; animation: fs-shimmer 1.2s infinite linear; border-radius: var(--radius-sm); min-height: 1.2rem; }

/* ============ REDUCED MOTION ============ */
@media (prefers-reduced-motion: reduce) { * { animation: none !important; transition: none !important; } }

/* RULES.HTML */
    .pills { display:flex; gap:6px; flex-wrap:wrap; }
    .pill { display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border:1px solid var(--border-strong); border-radius:999px; background:var(--card); }
    .pill > button { border:none; background:transparent; cursor:pointer; padding:0 2px; font-weight:600; }
    .rule-card{border:1px solid var(--border);border-radius:var(--radius);padding:12px;background:var(--card);box-shadow:var(--shadow-sm);display:grid;gap:12px}
    .rule-row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .pair{display:flex;gap:6px;align-items:center}
    .pair>label{color:var(--muted);min-width:72px}
    .rules-list .item{display:flex;gap:10px;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border)}
    .rules-list .item:last-child{border-bottom:0}
    .empty{color:var(--muted)}
    .btn{padding:8px 12px;border-radius:8px;border:1px solid var(--border-strong);background:var(--card);cursor:pointer;color:var(--ink)}
    .btn-primary{background:var(--accent);color:var(--accent-ink);border-color:transparent}
    .btn-danger{background:#ef4444;color:#fff;border-color:transparent}
    .btn-ghost{background:var(--ghost-bg);color:var(--ghost-ink);border-color:var(--border-strong)}
    select,input{padding:8px 10px;border:1px solid var(--border-strong);border-radius:8px;background:var(--card);color:var(--ink)}
    .value-select{min-width:220px}
    .muted-note{color:var(--muted);font-size:.9rem}
/* MATCHER.HTML */
    .nowrap { white-space: nowrap; }
    .truncate { max-width: 420px; display: inline-block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
/* INDEX.HTML */
    /* Compact editor layout for table rows */
    .compact-editor { display:flex; flex-wrap:wrap; gap:8px 12px; align-items:flex-start; }
    .compact-editor .pair {
      display:flex; align-items:center; gap:6px;
      padding:6px 8px;
      background:var(--card,#fff); border-radius:8px;
    }
    .compact-editor .pair .lbl { white-space:nowrap; font-size:0.95rem; color:var(--ink,#0f172a); }
    .compact-editor .pair input, .compact-editor .pair select {
      width:auto; min-width:120px; max-width:360px;
    }
    .table-card table { width:100%; table-layout:auto; border-collapse:collapse; }
    .table-card th, .table-card td { padding:6px 8px; border-bottom:1px solid var(--border,#e5e7eb); }
    .table-card tbody tr { cursor:pointer; }
    .table-card tbody tr[data-sel="1"] { background:#f0f9ff; }
    .right { margin-left:auto; }
    .btn-primary, .btn-secondary, .btn-danger { margin-right:6px; }
/* BUILDER.HTML */

    /* ---- Builder-only enhancements (non-invasive) ---- */
    :root {
      --ink: var(--ink, #0f172a);
      --muted: var(--muted, #6b7280);
      --border: var(--border, #e5e7eb);
      --card: var(--card, #ffffff);
      --bg: var(--bg, #f8fafc);
      --accent: var(--accent, #111827);
      --good: var(--good, #0a7);
      --danger: #b91c1c;
      --focus: #3b82f6;
      --radius: 10px;
      --gap: 12px;
    }

    /* Table: clearer lines */
    #fieldTable {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
      background: var(--card);
    }
    #fieldTable thead th {
      text-align: left;
      font-weight: 600;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      background: #f3f4f6;
      white-space: nowrap;
    }
    #fieldTable tbody td {
      padding: 9px 12px;
      border-bottom: 1px solid var(--border);
      border-right: 1px solid var(--border);
      vertical-align: top;
    }
    #fieldTable tbody tr:last-child td {
      border-bottom: 0;
    }
    #fieldTable tbody td:last-child {
      border-right: 0;
    }
    #fieldTable tbody tr:hover {
      background: #f9fafb;
    }
    #fieldTable tbody tr.is-active {
      background: #eef2ff;
      outline: 2px solid #c7d2fe;
      outline-offset: -2px;
    }
    #fieldTable .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }

    /* Drag & drop */
    .dnd-handle {
      cursor: grab;
      user-select: none;
      font-size: 18px;
      opacity: 0.75;
    }
    tr.dragging {
      opacity: 0.5;
    }
    .drop-target-above {
      box-shadow: inset 0 3px 0 0 #93c5fd;
    }
    .drop-target-below {
      box-shadow: inset 0 -3px 0 0 #93c5fd;
    }

    /* Buttons */
    button.ghost {
      background: transparent;
      border: 1px solid var(--border);
      color: var(--ink);
    }
    button.ghost:hover {
      background: #f9fafb;
    }
    button.danger {
      background: #fee2e2;
      border-color: #fecaca;
      color: #991b1b;
    }
    button.danger:hover {
      background: #fecaca;
    }

    /* Table Designer look & feel */
    .tdz-toolbar { display:flex; justify-content:space-between; align-items:center; margin:6px 0 10px; }
    .tdz-row {
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding:12px;
      border:1px solid var(--border);
      border-radius:10px;
      background: var(--card);
    }
    .tdz-row + .tdz-row { margin-top:10px; }
    .tdz-col { display:flex; flex-direction:column; gap:6px; }
    .tdz-col > label.small { color: var(--muted); font-size: 12px; }
    .tdz-col > input,
    .tdz-col > select {
      height: 34px;
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: #fff;
      outline: none;
      transition: box-shadow .15s ease, border-color .15s ease;
      min-width: 160px;
    }
    .tdz-col > input:focus,
    .tdz-col > select:focus {
      border-color: #c7d2fe;
      box-shadow: 0 0 0 3px rgba(99,102,241,.25);
    }
    .tdz-grow { flex:1 1 auto; }
    .tdz-actions { display:flex; gap:8px; align-items:center; margin-left:auto; }
    .tdz-chipwrap { display:flex; flex-wrap:wrap; gap:6px; }
    .tdz-chip {
      display:inline-flex; align-items:center; gap:6px;
      padding:2px 8px;
      border:1px solid var(--border);
      border-radius:999px;
      background:#fff;
      line-height: 22px;
    }
    .tdz-chip button { border:none; background:transparent; cursor:pointer; font-size: 16px; line-height: 1; }
    .tdz-opts { display:flex; gap:8px; align-items:center; }
    .tdz-muted { color:var(--muted); font-size:12px; }

/* --- Unified button class mapping (readable in all themes) --- */
:root{
  --btn-primary-bg: var(--accent, #3b82f6);
  --btn-primary-fg: #ffffff;
  --btn-primary-bg-hover: #2563eb;
  --btn-primary-border: transparent;

  --btn-secondary-bg: var(--accent-weak, #374151);
  --btn-secondary-fg: var(--accent-weak-ink, #ffffff);
  --btn-secondary-bg-hover: #2b3445;
  --btn-secondary-border: transparent;

  --btn-danger-bg: #ef4444;
  --btn-danger-fg: #ffffff;
  --btn-danger-bg-hover: #dc2626;
  --btn-danger-border: transparent;
}

/* PRIMARY (covers .btn-primary and .btn .btn-primary) */
.btn-primary,
.btn.btn-primary,
button.btn-primary {
  background-color: var(--btn-primary-bg) !important;
  color: var(--btn-primary-fg) !important;
  border: 1px solid var(--btn-primary-border) !important;
}
.btn-primary:hover:not(:disabled),
.btn.btn-primary:hover:not(:disabled),
button.btn-primary:hover:not(:disabled) {
  background-color: var(--btn-primary-bg-hover) !important;
}

/* SECONDARY */
.btn-secondary,
.btn.btn-secondary,
button.btn-secondary {
  background-color: var(--btn-secondary-bg) !important;
  color: var(--btn-secondary-fg) !important;
  border: 1px solid var(--btn-secondary-border) !important;
}
.btn-secondary:hover:not(:disabled),
.btn.btn-secondary:hover:not(:disabled),
button.btn-secondary:hover:not(:disabled) {
  background-color: var(--btn-secondary-bg-hover) !important;
}

/* DANGER */
.btn-danger,
.btn.btn-danger,
button.btn-danger {
  background-color: var(--btn-danger-bg) !important;
  color: var(--btn-danger-fg) !important;
  border: 1px solid var(--btn-danger-border) !important;
}
.btn-danger:hover:not(:disabled),
.btn.btn-danger:hover:not(:disabled),
button.btn-danger:hover:not(:disabled) {
  background-color: var(--btn-danger-bg-hover) !important;
}

/* Disabled state */
.btn-primary:disabled,
.btn.btn-primary:disabled,
button.btn-primary:disabled,
.btn-secondary:disabled,
.btn.btn-secondary:disabled,
button.btn-secondary:disabled,
.btn-danger:disabled,
.btn.btn-danger:disabled,
button.btn-danger:disabled {
  opacity: 0.6 !important;
  cursor: not-allowed !important;
  box-shadow: none !important;
  transform: none !important;
}

/* Keep RULES page spacing helper */
.btn-primary, .btn-secondary, .btn-danger { margin-right: 6px; }

/* -------------------------------------------------------------
   END
   ------------------------------------------------------------- */
